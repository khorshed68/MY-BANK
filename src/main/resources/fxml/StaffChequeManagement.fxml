<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.mybank.controllers.StaffChequeController"
            prefHeight="900.0" prefWidth="1400.0"
            stylesheets="@../css/style.css">

    <!-- Header -->
    <top>
        <VBox styleClass="header" alignment="CENTER" spacing="10">
            <padding><Insets top="20" right="20" bottom="20" left="20"/></padding>
            
            <Label text="Staff - Cheque Management System" styleClass="header-title">
                <font><Font name="Arial Bold" size="28"/></font>
            </Label>
            
            <HBox spacing="10" alignment="CENTER">
                <Button text="Refresh All" onAction="#handleRefresh" styleClass="primary-button" style="-fx-text-fill: black;"/>
                <Button text="Back to Dashboard" onAction="#handleBackToDashboard" styleClass="secondary-button"/>
            </HBox>
        </VBox>
    </top>

    <!-- Main Content -->
    <center>
        <TabPane tabClosingPolicy="UNAVAILABLE">
            <padding><Insets top="10" right="10" bottom="10" left="10"/></padding>
            
            <!-- Pending Requests Tab -->
            <Tab text="Pending Requests">
                <VBox spacing="15">
                    <padding><Insets top="15" right="15" bottom="15" left="15"/></padding>
                    
                    <Label text="Cheque Book Requests - Awaiting Approval" styleClass="section-title">
                        <font><Font name="Arial Bold" size="18"/></font>
                    </Label>
                    
                    <TableView fx:id="pendingRequestsTable" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="reqBookNumberCol" text="Book Number" prefWidth="120"/>
                            <TableColumn fx:id="reqAccountCol" text="Account" prefWidth="130"/>
                            <TableColumn fx:id="reqCustomerCol" text="Customer Name" prefWidth="150"/>
                            <TableColumn fx:id="reqAccountTypeCol" text="Account Type" prefWidth="100"/>
                            <TableColumn fx:id="reqBalanceCol" text="Balance (TAKA)" prefWidth="100"/>
                            <TableColumn fx:id="reqLeavesCol" text="Leaves" prefWidth="70"/>
                            <TableColumn fx:id="reqDateCol" text="Request Date" prefWidth="150"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                    </TableView>
                    
                    <GridPane hgap="20" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="50"/>
                            <ColumnConstraints percentWidth="50"/>
                        </columnConstraints>
                        
                        <!-- Approve Section -->
                        <VBox spacing="10" GridPane.columnIndex="0" GridPane.rowIndex="0"
                              style="-fx-background-color: #e8f5e9; -fx-padding: 15; -fx-border-color: #4caf50; -fx-border-radius: 5;">
                            <Label text="Approve Request" style="-fx-font-weight: bold; -fx-font-size: 14; -fx-text-fill: #2e7d32;"/>
                            <Label text="Approval Remarks (Optional):"/>
                            <TextArea fx:id="approvalRemarksArea" promptText="Enter any remarks for approval..." prefRowCount="3"/>
                            <Button fx:id="approveRequestBtn" text="✓ Approve Request" 
                                    onAction="#handleApproveRequest" 
                                    styleClass="success-button"
                                    style="-fx-text-fill: black;"
                                    prefWidth="200"/>
                        </VBox>
                        
                        <!-- Reject Section -->
                        <VBox spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="0"
                              style="-fx-background-color: #ffebee; -fx-padding: 15; -fx-border-color: #f44336; -fx-border-radius: 5;">
                            <Label text="Reject Request" style="-fx-font-weight: bold; -fx-font-size: 14; -fx-text-fill: #c62828;"/>
                            <Label text="Rejection Reason (Required):"/>
                            <TextArea fx:id="rejectionReasonArea" promptText="Enter reason for rejection..." prefRowCount="3"/>
                            <Button fx:id="rejectRequestBtn" text="✗ Reject Request" 
                                    onAction="#handleRejectRequest" 
                                    styleClass="danger-button"
                                    style="-fx-text-fill: black;"
                                    prefWidth="200"/>
                        </VBox>
                    </GridPane>
                </VBox>
            </Tab>
            
            <!-- Cheque Clearance Tab -->
            <Tab text="Cheque Clearance">
                <VBox spacing="15">
                    <padding><Insets top="15" right="15" bottom="15" left="15"/></padding>
                    
                    <Label text="Deposited Cheques - Pending Clearance" styleClass="section-title">
                        <font><Font name="Arial Bold" size="18"/></font>
                    </Label>
                    
                    <TableView fx:id="depositedChequesTable" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="depChequeNumCol" text="Cheque Number" prefWidth="130"/>
                            <TableColumn fx:id="depAccountCol" text="Account" prefWidth="120"/>
                            <TableColumn fx:id="depPayerCol" text="Payer Name" prefWidth="130"/>
                            <TableColumn fx:id="depAmountCol" text="Amount (TAKA)" prefWidth="100"/>
                            <TableColumn fx:id="depCurrentBalanceCol" text="Account Balance" prefWidth="110"/>
                            <TableColumn fx:id="depIssueDateCol" text="Issue Date" prefWidth="100"/>
                            <TableColumn fx:id="depDepositDateCol" text="Deposit Date" prefWidth="140"/>
                            <TableColumn fx:id="depDepositedByCol" text="Deposited By" prefWidth="130"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                    </TableView>
                    
                    <GridPane hgap="20" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="50"/>
                            <ColumnConstraints percentWidth="50"/>
                        </columnConstraints>
                        
                        <!-- Clear Section -->
                        <VBox spacing="10" GridPane.columnIndex="0" GridPane.rowIndex="0"
                              style="-fx-background-color: #e3f2fd; -fx-padding: 15; -fx-border-color: #2196f3; -fx-border-radius: 5;">
                            <Label text="Clear Cheque" style="-fx-font-weight: bold; -fx-font-size: 14; -fx-text-fill: #1565c0;"/>
                            <CheckBox fx:id="signatureVerifiedCheck" text="Signature Verified" 
                                     style="-fx-font-weight: bold;"/>
                            <Label text="Clearance Remarks (Optional):"/>
                            <TextArea fx:id="clearanceRemarksArea" promptText="Enter clearance remarks..." prefRowCount="2"/>
                            <Button fx:id="clearChequeBtn" text="✓ Clear Cheque" 
                                    onAction="#handleClearCheque" 
                                    styleClass="success-button"
                                    prefWidth="200"/>
                            <Label text="Note: Verify signature and balance before clearing" 
                                   style="-fx-font-size: 11; -fx-text-fill: #666;" wrapText="true"/>
                        </VBox>
                        
                        <!-- Bounce Section -->
                        <VBox spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="0"
                              style="-fx-background-color: #fff3e0; -fx-padding: 15; -fx-border-color: #ff9800; -fx-border-radius: 5;">
                            <Label text="Bounce Cheque" style="-fx-font-weight: bold; -fx-font-size: 14; -fx-text-fill: #e65100;"/>
                            <Label text="Bounce Reason (Required):"/>
                            <TextArea fx:id="bounceReasonArea" promptText="Reason: Insufficient balance, Signature mismatch, etc." prefRowCount="2"/>
                            <Button fx:id="bounceChequeBtn" text="⚠ Bounce Cheque" 
                                    onAction="#handleBounceCheque" 
                                    styleClass="warning-button"
                                    prefWidth="200"/>
                            <Label text="Common reasons: Insufficient funds, Signature mismatch, Post-dated, Account closed" 
                                   style="-fx-font-size: 11; -fx-text-fill: #666;" wrapText="true"/>
                        </VBox>
                    </GridPane>
                </VBox>
            </Tab>
            
            <!-- All Cheque Books Tab -->
            <Tab text="All Cheque Books">
                <VBox spacing="10">
                    <padding><Insets top="15" right="15" bottom="15" left="15"/></padding>
                    
                    <Label text="All Cheque Books" styleClass="section-title">
                        <font><Font name="Arial Bold" size="18"/></font>
                    </Label>
                    
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="Search:"/>
                        <TextField fx:id="searchBookField" promptText="Book number, account, or customer..." prefWidth="250"/>
                        <Button text="Search" onAction="#handleSearchBooks" styleClass="secondary-button"/>
                        <Label text="Filter by Status:"/>
                        <ComboBox fx:id="statusFilterCombo" prefWidth="150"/>
                    </HBox>
                    
                    <TableView fx:id="allBooksTable" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="allBookNumberCol" text="Book Number" prefWidth="120"/>
                            <TableColumn fx:id="allAccountCol" text="Account" prefWidth="130"/>
                            <TableColumn fx:id="allCustomerCol" text="Customer" prefWidth="150"/>
                            <TableColumn fx:id="allStatusCol" text="Status" prefWidth="100"/>
                            <TableColumn fx:id="allRemainingCol" text="Remaining Leaves" prefWidth="120"/>
                            <TableColumn fx:id="allApprovalDateCol" text="Approval Date" prefWidth="150"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                    </TableView>
                </VBox>
            </Tab>
            
            <!-- All Cheques Tab -->
            <Tab text="All Cheques">
                <VBox spacing="10">
                    <padding><Insets top="15" right="15" bottom="15" left="15"/></padding>
                    
                    <Label text="All Cheques" styleClass="section-title">
                        <font><Font name="Arial Bold" size="18"/></font>
                    </Label>
                    
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="Search:"/>
                        <TextField fx:id="searchChequeField" promptText="Cheque number, account, or payee..." prefWidth="250"/>
                        <Button text="Search" onAction="#handleSearchCheques" styleClass="secondary-button"/>
                        <Label text="Filter by Status:"/>
                        <ComboBox fx:id="chequeStatusFilterCombo" prefWidth="150"/>
                    </HBox>
                    
                    <TableView fx:id="allChequesTable" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="allChequeNumCol" text="Cheque Number" prefWidth="130"/>
                            <TableColumn fx:id="allChequeAccountCol" text="Account" prefWidth="130"/>
                            <TableColumn fx:id="allChequeAmountCol" text="Amount (TAKA)" prefWidth="100"/>
                            <TableColumn fx:id="allChequePayeeCol" text="Payee" prefWidth="150"/>
                            <TableColumn fx:id="allChequeStatusCol" text="Status" prefWidth="120"/>
                            <TableColumn fx:id="allChequeClearanceDateCol" text="Clearance Date" prefWidth="150"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                    </TableView>
                </VBox>
            </Tab>
            
            <!-- Statistics Tab -->
            <Tab text="Statistics">
                <ScrollPane fitToWidth="true">
                    <VBox spacing="25">
                        <padding><Insets top="25" right="25" bottom="25" left="25"/></padding>
                        
                        <Label text="Cheque Management Statistics" styleClass="section-title">
                            <font><Font name="Arial Bold" size="20"/></font>
                        </Label>
                        
                        <!-- Cheque Book Statistics -->
                        <VBox spacing="15" style="-fx-background-color: #f5f5f5; -fx-padding: 20; -fx-border-radius: 10;">
                            <Label text="Cheque Book Statistics" style="-fx-font-weight: bold; -fx-font-size: 16;"/>
                            <GridPane hgap="30" vgap="15">
                                <columnConstraints>
                                    <ColumnConstraints percentWidth="25"/>
                                    <ColumnConstraints percentWidth="25"/>
                                    <ColumnConstraints percentWidth="25"/>
                                    <ColumnConstraints percentWidth="25"/>
                                </columnConstraints>
                                
                                <VBox spacing="5" alignment="CENTER" GridPane.columnIndex="0" GridPane.rowIndex="0"
                                      style="-fx-background-color: #2196f3; -fx-padding: 20; -fx-background-radius: 10;">
                                    <Label text="Total Requests" style="-fx-text-fill: white; -fx-font-size: 14;"/>
                                    <Label fx:id="totalRequestsLabel" text="0" 
                                           style="-fx-text-fill: white; -fx-font-size: 32; -fx-font-weight: bold;"/>
                                </VBox>
                                
                                <VBox spacing="5" alignment="CENTER" GridPane.columnIndex="1" GridPane.rowIndex="0"
                                      style="-fx-background-color: #ff9800; -fx-padding: 20; -fx-background-radius: 10;">
                                    <Label text="Pending Approval" style="-fx-text-fill: white; -fx-font-size: 14;"/>
                                    <Label fx:id="pendingRequestsLabel" text="0" 
                                           style="-fx-text-fill: white; -fx-font-size: 32; -fx-font-weight: bold;"/>
                                </VBox>
                                
                                <VBox spacing="5" alignment="CENTER" GridPane.columnIndex="2" GridPane.rowIndex="0"
                                      style="-fx-background-color: #4caf50; -fx-padding: 20; -fx-background-radius: 10;">
                                    <Label text="Approved Books" style="-fx-text-fill: white; -fx-font-size: 14;"/>
                                    <Label fx:id="approvedBooksLabel" text="0" 
                                           style="-fx-text-fill: white; -fx-font-size: 32; -fx-font-weight: bold;"/>
                                </VBox>
                                
                                <VBox spacing="5" alignment="CENTER" GridPane.columnIndex="3" GridPane.rowIndex="0"
                                      style="-fx-background-color: #9c27b0; -fx-padding: 20; -fx-background-radius: 10;">
                                    <Label text="Active Books" style="-fx-text-fill: white; -fx-font-size: 14;"/>
                                    <Label fx:id="activeBooksLabel" text="0" 
                                           style="-fx-text-fill: white; -fx-font-size: 32; -fx-font-weight: bold;"/>
                                </VBox>
                            </GridPane>
                        </VBox>
                        
                        <!-- Cheque Statistics -->
                        <VBox spacing="15" style="-fx-background-color: #f5f5f5; -fx-padding: 20; -fx-border-radius: 10;">
                            <Label text="Cheque Statistics" style="-fx-font-weight: bold; -fx-font-size: 16;"/>
                            <GridPane hgap="30" vgap="15">
                                <columnConstraints>
                                    <ColumnConstraints percentWidth="25"/>
                                    <ColumnConstraints percentWidth="25"/>
                                    <ColumnConstraints percentWidth="25"/>
                                    <ColumnConstraints percentWidth="25"/>
                                </columnConstraints>
                                
                                <VBox spacing="5" alignment="CENTER" GridPane.columnIndex="0" GridPane.rowIndex="0"
                                      style="-fx-background-color: #607d8b; -fx-padding: 20; -fx-background-radius: 10;">
                                    <Label text="Total Cheques" style="-fx-text-fill: white; -fx-font-size: 14;"/>
                                    <Label fx:id="totalChequesLabel" text="0" 
                                           style="-fx-text-fill: white; -fx-font-size: 32; -fx-font-weight: bold;"/>
                                </VBox>
                                
                                <VBox spacing="5" alignment="CENTER" GridPane.columnIndex="1" GridPane.rowIndex="0"
                                      style="-fx-background-color: #00bcd4; -fx-padding: 20; -fx-background-radius: 10;">
                                    <Label text="Pending Clearance" style="-fx-text-fill: white; -fx-font-size: 14;"/>
                                    <Label fx:id="pendingClearanceLabel" text="0" 
                                           style="-fx-text-fill: white; -fx-font-size: 32; -fx-font-weight: bold;"/>
                                </VBox>
                                
                                <VBox spacing="5" alignment="CENTER" GridPane.columnIndex="2" GridPane.rowIndex="0"
                                      style="-fx-background-color: #4caf50; -fx-padding: 20; -fx-background-radius: 10;">
                                    <Label text="Cleared Cheques" style="-fx-text-fill: white; -fx-font-size: 14;"/>
                                    <Label fx:id="clearedChequesLabel" text="0" 
                                           style="-fx-text-fill: white; -fx-font-size: 32; -fx-font-weight: bold;"/>
                                </VBox>
                                
                                <VBox spacing="5" alignment="CENTER" GridPane.columnIndex="3" GridPane.rowIndex="0"
                                      style="-fx-background-color: #f44336; -fx-padding: 20; -fx-background-radius: 10;">
                                    <Label text="Bounced Cheques" style="-fx-text-fill: white; -fx-font-size: 14;"/>
                                    <Label fx:id="bouncedChequesLabel" text="0" 
                                           style="-fx-text-fill: white; -fx-font-size: 32; -fx-font-weight: bold;"/>
                                </VBox>
                            </GridPane>
                        </VBox>
                    </VBox>
                </ScrollPane>
            </Tab>
        </TabPane>
    </center>
</BorderPane>
